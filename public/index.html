<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes, viewport-fit=cover" />
  <meta name="theme-color" content="#05060a" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
  <meta name="apple-mobile-web-app-title" content="Party Link" />
  <meta name="mobile-web-app-capable" content="yes" />
  <meta name="format-detection" content="telephone=no" />
  <meta name="description" content="Host party games with friends - Truth or Dare, Never Have I Ever, Who's Most Likely, and more. No downloads, no logins." />
  <title>Party Link â€“ Multiplayer Party Games</title>
  <link rel="manifest" href="/manifest.json" />
  <link rel="stylesheet" href="/styles.css" />
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;600;700&display=swap" rel="stylesheet" />
  <link rel="apple-touch-icon" href="/icon-192.png" />
  <link rel="apple-touch-icon" sizes="180x180" href="/icon-192.png" />
  <!-- Splash screens for iOS -->
  <meta name="apple-mobile-web-app-title" content="Party Link" />
</head>
<body>
  <div class="app">
    <header>
      <div class="header-left">
        <button id="homeBtn" class="home-btn" hidden title="Leave and go home">ğŸ </button>
        <div>
          <p class="eyebrow">ğŸ‰ Party Games Hub</p>
          <h1>One link. Multiple games. Pure chaos.</h1>
        </div>
      </div>
      <div class="pill">ğŸ”— Local Multiplayer</div>
    </header>

    <section class="card" id="connect-card">
      <div class="row">
        <label class="field">
          <span>Your display name</span>
          <input id="nameInput" type="text" placeholder="Enter your name..." maxlength="16" autocomplete="off" spellcheck="false" />
        </label>
        
        <!-- Normal mode: host + join options -->
        <div class="actions" id="hostActions">
          <button id="hostBtn" class="primary">ğŸ® Host a Room</button>
          <div class="join-row">
            <input id="roomInput" type="text" placeholder="ABC" maxlength="3" autocomplete="off" spellcheck="false" style="text-transform: uppercase;" />
            <button id="joinBtn" class="secondary">Join</button>
          </div>
        </div>
        
        <!-- QR join mode: only join button, no host option -->
        <div class="actions" id="joinOnlyActions" style="display: none;">
          <p class="join-info">Joining room <strong id="joiningRoomCode">---</strong></p>
          <button id="joinOnlyBtn" class="primary large">ğŸš€ Join Game</button>
        </div>
      </div>
      <p id="status" class="status">Connecting...</p>
    </section>

    <section class="card compact" id="room-card" hidden>
      <!-- Full room header for HOST only -->
      <div class="room-header" id="roomHeader" hidden>
        <div>
          <p class="eyebrow">ğŸ  Room</p>
          <h2 id="roomCode">-</h2>
          <p class="muted" id="hostTag"></p>
        </div>
        <div class="room-right">
          <div class="qr-block" id="qrBlock" hidden>
            <div id="qr" class="qr"></div>
            <p class="muted tiny" id="qrHint">Scan to join</p>
          </div>
        </div>
      </div>
      
      <!-- Minimal info for PLAYERS (non-host) -->
      <div class="player-room-info" id="playerRoomInfo" hidden>
        <span class="room-badge">ğŸ® <span id="roomCodeSmall">-</span></span>
        <button id="leaveBtnSmall" class="leave-link">Leave</button>
      </div>
      
      <div class="players" id="playersSection">
        <p class="eyebrow">ğŸ‘¥ Players (<span id="playerCount">0</span>)</p>
        <ul id="playerList"></ul>
      </div>
      <button id="leaveBtn" class="ghost danger-ghost small-leave">ğŸšª Leave</button>
    </section>

    <section class="card" id="control-card" hidden>
      <div class="control-head">
        <div>
          <p class="eyebrow">ğŸ›ï¸ Host Controls</p>
          <h3 id="controlTitle">Pick a Game</h3>
          <p class="muted">Select a game to play. Everyone syncs automatically.</p>
        </div>
        <label class="field mini">
          <span>ğŸ¨ Theme</span>
          <select id="themeSelect">
            <option value="classic">Classic</option>
            <option value="party" selected>Party ğŸ‰</option>
            <option value="after-dark">After Dark 18+ ğŸ”¥</option>
          </select>
        </label>
      </div>
      <div id="gameGrid" class="game-grid"></div>
    </section>

    <section class="card" id="current-card" hidden>
      <div class="current-head">
        <div>
          <p class="eyebrow">ğŸ® Now Playing</p>
          <h3 id="currentTitle">-</h3>
          <p class="muted" id="currentBlurb"></p>
        </div>
        <div class="badge-row">
          <div id="gameBadges" class="badge-row"></div>
          <button id="switchGame" class="secondary">ğŸ”„ Switch</button>
        </div>
      </div>
      <div id="gameContainer"></div>
    </section>
  </div>
  
  <div id="toast" class="toast"></div>
  
  <script src="https://unpkg.com/qrcodejs@1.0.0/qrcode.min.js"></script>
  <script type="module" src="/app.js"></script>
</body>
</html>
